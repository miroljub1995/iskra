using Iskra.StdWebGenerator.Extensions;

namespace Iskra.StdWebGenerator;

public static class JSTypeGenerator
{
    public static string Execute(Type type)
    {
        var body = MembersGenerator.Execute(type);

        var isStatic = type is { IsAbstract: true, IsSealed: true };
        var staticKeyword = isStatic ? " static" : "";
        var defaultConstructor = isStatic ? null : "(JSObject obj)";
        var baseType = isStatic ? null : " : JSObjectWrapper(obj)";

        var content = $$"""
                        // <auto-generated/>

                        using System.Runtime.InteropServices.JavaScript;
                        using Iskra.Utils;

                        namespace Iskra.StdWeb;

                        public{{staticKeyword}} partial class {{type.Name}}{{defaultConstructor}}{{baseType}}
                        {
                        {{body.IndentLines(4)}}
                        }
                        """;
        return content;
    }
}