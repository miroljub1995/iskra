<html>
<head>
    <script type="module">
        import {dotnet} from "/_framework/dotnet.js";

        const run = async () => {
            const {runMain, getConfig, setModuleImports} = await dotnet.create();

            setModuleImports('iskra', {
                constructGlobalObject: (constructorName, ...args) => new globalThis[constructorName](...args),
                isGlobalConstructor: (constructorName, target) => globalThis[constructorName] === target.constructor,
                arrowFunctionProxy: (fun) => (...args) => fun(...args),
            });

            const cfg = await getConfig();
            const res = await runMain(cfg.mainAssemblyName, []);

            return res;
        }

        globalThis.run = run;
    </script>
</head>
<body>
</body>
</html>